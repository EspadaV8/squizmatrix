<?php
/**
* +--------------------------------------------------------------------+
* | Squiz.net Open Source Licence                                      |
* +--------------------------------------------------------------------+
* | Copyright (c), 2003 Squiz Pty Ltd (ABN 77 084 670 600).            |
* +--------------------------------------------------------------------+
* | This source file may be used subject to, and only in accordance    |
* | with, the Squiz Open Source Licence Agreement found at             |
* | http://www.squiz.net/licence.                                      |
* | Make sure you have read and accept the terms of that licence,      |
* | including its limitations of liability and disclaimers, before     |
* | using this software in any way. Your use of this software is       |
* | deemed to constitute agreement to be bound by that licence. If you |
* | modify, adapt or enhance this software, you agree to assign your   |
* | intellectual property rights in the modification, adaptation and   |
* | enhancement to Squiz Pty Ltd for use and distribution under that   |
* | licence.                                                           |
* +--------------------------------------------------------------------+
*
* $Id: page_calendar_restricted.inc~,v 1.1 2005/06/26 23:40:28 pgannavarapu Exp $
*
*/


require_once SQ_CORE_PACKAGE_PATH.'/page/page.inc';
require_once SQ_FUDGE_PATH.'/general/text.inc';
require_once SQ_PACKAGES_PATH.'/calendar/lib/calendar_common.inc';
require_once SQ_PACKAGES_PATH.'/calendar/page_templates/page_calendar_rolling/page_calendar_rolling.inc';

/**
* Page_Calendar_Restricted
*
* Purpose
*
*
* @author  Greg Sherwoood <greg@squiz.net>
* @version $Revision: 1.1 $
* @package MySource_Matrix_Packages
* @subpackage calendar
*/
class Page_Calendar_Restricted extends Page_Calendar_Rolling
{


	/**
	* Constructor
	*
	* @param int	$assetid	the asset id to be loaded
	*
	*/
	function Page_Calendar_Restricted($assetid=0)
	{
		//$this->_ser_attrs = true;
		$this->Page_Calendar_Rolling($assetid);

	}//end constructor


	/**
	* Get the events that should be displayed in this calendar page
	*
	* @access public
	* @return array (date => array (assetid => array ( details )))
	*/
	function getEvents()
	{
		$start_date = substr($this->attr('start_date'), 0, 10);
		$end_date = substr($this->attr('end_date'), 0, 10);
		$length = $this->attr('days_per_page');
		$display_date = date('Y-m-d');
		if ($display_date < $start_date){
			$display_date = $start_date;
		}
		if ($display_date > date('Y-m-d', strtotime($end_date.' -'.($length-1).' days'))) {
			$display_date = date('Y-m-d', strtotime($end_date.' -'.($length-1).' days'));
		}
		return parent::getEvents($display_date,date('Y-m-d', strtotime($display_date.' +'.($length-1).' days')));

	}//end getEvents()

27/06/2005
}//end class
?>